app-id: org.qgis.qgis
branch: development
runtime: org.kde.Platform
runtime-version: "5.15-23.08"
base: io.qt.qtwebkit.Base   #https://github.com/mattiasegly/flatpak-qtwebkit
base-version: "development"
sdk: org.kde.Sdk
command: qgis
rename-icon: qgis
#
separate-locales: false
finish-args:
  - --share=ipc
  - --share=network
  - --device=dri
# - --socket=wayland   #forced x11 in openscenegraph
  - --socket=x11
  - --filesystem=home
  - --env=LD_LIBRARY_PATH=/app/lib:/app/lib64
  - --env=PYTHONPATH=/app/lib/python3.11/site-packages
#
cleanup:   #https://github.com/flatpak/flatpak-builder/issues/233
  - /include
  - /lib/pkgconfig
  - /share/cmake
  - /share/doc
  - /share/man
  - /share/pkgconfig
  - '*.la'
  - '*.a'
cleanup-commands:
  - rm -rf /app/{include,lib/{cmake,mkspecs,pkgconfig}}
#
build-options:
  env:
    PYTHONPATH: /app/lib/python3.11/site-packages:/usr/lib/python3.11/site-packages
#
modules:
  - modules/flit-core.yml               #required by packaging/qgis core plugins
  - modules/packaging.yml               #required by sip/qgis core plugins
  - modules/tomli.yml                   #required by sip/qgis core plugins
  - modules/ply.yml                     #required by sip
  - modules/sip.yml                     #required by pyqt-builder/pyqt5-sip/pyqt5/qscintilla-bindings/kadas-qgis/kadas-albireo2
  - modules/pyqt-builder.yml            #required by pyqt5/qscintilla-bindings
  - modules/pyqt5-sip.yml               #required by pyqt5
  - modules/pyqt5.yml                   #required by kadas-qgis/kadas-albireo2
  - modules/qscintilla.yml              #required by qscintilla-bindings/kadas-qgis
  - modules/qscintilla-bindings.yml     #required by kadas-qgis
  - modules/tcl.yml                     #required by sqlite, optional to swig/postgresql, enabled
  - modules/sqlite.yml                  #required by proj/libspatialite/gdal/kadas-qgis
  - modules/proj.yml                    #required by libspatialite/gdal/kadas-qgis
  - modules/pyproject-metadata.yml      #required by meson-python/numpy
  - modules/meson-python.yml            #required by numpy
  - modules/openblas.yml                #required by numpy
  - modules/numpy.yml                   #required by swig/gdal
  - modules/swig.yml                    #required by gdal
  - modules/geos.yml                    #required by librttopo/libspatialite/gdal/kadas-qgis
  - modules/librttopo.yml               #required by libspatialite
  - modules/minizip.yml                 #required by freexl/libspatialite
  - modules/freexl.yml                  #required by libspatialite, optional to gdal
  - modules/libspatialite.yml           #required by kadas-qgis, optional to gdal
  - modules/opencl-headers.yml          #optional to gdal/kadas-qgis, enabled
  - modules/hdf5.yml                    #optional to gdal/kadas-qgis, required by netcdf-c
  - modules/netcdf-c.yml                #optional to gdal/kadas-qgis
  - modules/postgresql.yml              #optional to gdal/kadas-qgis, required by psycopg2
  - modules/gdal.yml                    #required by kadas-qgis
  - modules/libzip.yml                  #required by kadas-qgis
  - modules/protobuf.yml                #required by kadas-qgis
  - modules/gsl.yml                     #required by kadas-qgis
  - modules/libspatialindex.yml         #required by kadas-qgis
  - modules/exiv2.yml                   #required by kadas-qgis/kadas-albireo2
  - modules/qwt.yml                     #required by kadas-qgis/kadas-albireo2
  - modules/qtkeychain.yml              #required by kadas-qgis/kadas-albireo2
  - modules/qca.yml                     #required by kadas-qgis/kadas-albireo2

  - modules/psycopg2.yml                #required by qgis core plugins
  - modules/jinja2.yml                  #required by qgis core plugins
  - modules/typing-extensions.yml       #required by qgis core plugins
  - modules/setuptools-scm.yml          #required by qgis core plugins
  - modules/pluggy.yml                  #required by qgis core plugins
  - modules/pathspec.yml                #required by qgis core plugins
  - modules/editables.yml               #required by qgis core plugins
  - modules/trove-classifiers.yml       #required by qgis core plugins
  - modules/hatchling.yml               #required by qgis core plugins
  - modules/pygments.yml                #required by qgis core plugins
  - modules/urllib3.yml                 #required by qgis core plugins
  - modules/idna.yml                    #required by qgis core plugins
  - modules/charset-normalizer.yml      #required by qgis core plugins
  - modules/certifi.yml                 #required by qgis core plugins
  - modules/requests.yml                #required by qgis core plugins
  - modules/python-dateutil.yml         #required by qgis core plugins
  - modules/pyyaml.yml                  #required by qgis core plugins
  - modules/pytz.yml                    #required by qgis core plugins
  - modules/lxml.yml                    #required by qgis core plugins/kadas-gpkg-plugin
  - modules/owslib.yml                  #required by qgis core plugins

  - modules/kadas-qgis.yml
